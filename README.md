# AI å¯¹è¯åº”ç”¨ - Spring AI å®ç°

ä¸€ä¸ªåŸºäº Spring AI çš„æ™ºèƒ½å¯¹è¯åº”ç”¨ï¼Œé›†æˆäº† RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰ã€MCPï¼ˆæ¨¡å‹ä¸Šä¸‹æ–‡åè®®ï¼‰å’Œ Agent åŠŸèƒ½ï¼Œä½¿ç”¨ PostgreSQL ä½œä¸ºå‘é‡æ•°æ®åº“ã€‚

## ğŸ“‹ ç›®å½•

- [é¡¹ç›®æ¦‚è¿°](#é¡¹ç›®æ¦‚è¿°)
- [æŠ€æœ¯æ ˆ](#æŠ€æœ¯æ ˆ)
- [åŠŸèƒ½ç‰¹æ€§](#åŠŸèƒ½ç‰¹æ€§)
- [ç³»ç»Ÿæ¶æ„](#ç³»ç»Ÿæ¶æ„)
- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
- [Ollama é…ç½®](#ollama-é…ç½®)
- [é¡¹ç›®ç»“æ„](#é¡¹ç›®ç»“æ„)
- [å¼€å‘æŒ‡å—](#å¼€å‘æŒ‡å—)
- [éƒ¨ç½²è¯´æ˜](#éƒ¨ç½²è¯´æ˜)
- [API æ–‡æ¡£](#api-æ–‡æ¡£)
- [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

## ğŸ¯ é¡¹ç›®æ¦‚è¿°

æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªä¼ä¸šçº§ AI å¯¹è¯åº”ç”¨ï¼Œæ”¯æŒï¼š

- **RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰**ï¼šé€šè¿‡å‘é‡æ•°æ®åº“æ£€ç´¢ç›¸å…³æ–‡æ¡£ï¼Œå¢å¼º AI å›ç­”çš„å‡†ç¡®æ€§å’Œç›¸å…³æ€§
- **MCPï¼ˆæ¨¡å‹ä¸Šä¸‹æ–‡åè®®ï¼‰**ï¼šæä¾›æ ‡å‡†åŒ–çš„æ¨¡å‹ä¸Šä¸‹æ–‡ç®¡ç†
- **Agent åŠŸèƒ½**ï¼šæ”¯æŒå¤šè½®å¯¹è¯ã€å·¥å…·è°ƒç”¨å’Œä»»åŠ¡è§„åˆ’
- **å‘é‡æ•°æ®åº“**ï¼šä½¿ç”¨ PostgreSQL + pgvector å­˜å‚¨å’Œæ£€ç´¢æ–‡æ¡£å‘é‡
- **ç°ä»£åŒ–å‰ç«¯**ï¼šç¾è§‚çš„ Web ç•Œé¢ï¼Œæä¾›æµç•…çš„å¯¹è¯ä½“éªŒ

## ğŸ›  æŠ€æœ¯æ ˆ

### åç«¯
- **Java 21+**
- **Spring Boot 3.x**
- **Spring AI**ï¼šAI é›†æˆæ¡†æ¶
- **PostgreSQL 15+**ï¼šå…³ç³»å‹æ•°æ®åº“
- **pgvector**ï¼šPostgreSQL å‘é‡æ‰©å±•
- **MyBatis**ï¼šæ•°æ®è®¿é—®å±‚
- **Spring WebFlux**ï¼šå“åº”å¼ Web æ¡†æ¶ï¼ˆå¯é€‰ï¼‰
- **Maven/Gradle**ï¼šæ„å»ºå·¥å…·

### å‰ç«¯
- **React 18+** æˆ– **Vue 3+**
- **TypeScript**
- **Tailwind CSS**ï¼šæ ·å¼æ¡†æ¶
- **Vite**ï¼šæ„å»ºå·¥å…·
- **Axios**ï¼šHTTP å®¢æˆ·ç«¯
- **React Query** æˆ– **Vue Query**ï¼šæ•°æ®è·å–

### AI æ¨¡å‹
- **OpenAI GPT-4** / **Claude** / **Ollamaï¼ˆæœ¬åœ°æ¨¡å‹ï¼‰**ï¼ˆé€šè¿‡ Spring AI æŠ½è±¡å±‚æ”¯æŒï¼‰

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### 1. RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰
- æ–‡æ¡£ä¸Šä¼ å’Œè§£æï¼ˆæ”¯æŒ PDFã€Wordã€TXTã€Markdown ç­‰ï¼‰
- æ–‡æ¡£åˆ†å—å’Œå‘é‡åŒ–
- è¯­ä¹‰ç›¸ä¼¼åº¦æœç´¢
- ä¸Šä¸‹æ–‡å¢å¼ºçš„ AI å›ç­”

### 2. MCPï¼ˆæ¨¡å‹ä¸Šä¸‹æ–‡åè®®ï¼‰
- ç»Ÿä¸€çš„æ¨¡å‹ä¸Šä¸‹æ–‡ç®¡ç†
- ä¸Šä¸‹æ–‡æŒä¹…åŒ–
- ä¸Šä¸‹æ–‡å…±äº«å’Œå¤ç”¨

### 3. Agent åŠŸèƒ½
- å¤šè½®å¯¹è¯ç®¡ç†
- å·¥å…·è°ƒç”¨ï¼ˆTool Callingï¼‰
- ä»»åŠ¡è§„åˆ’å’Œæ‰§è¡Œ
- è®°å¿†ç®¡ç†

### 4. ç”¨æˆ·ç•Œé¢
- å®æ—¶å¯¹è¯ç•Œé¢
- æ–‡æ¡£ç®¡ç†ç•Œé¢
- å¯¹è¯å†å²æŸ¥çœ‹
- å“åº”å¼è®¾è®¡ï¼Œæ”¯æŒç§»åŠ¨ç«¯

## ğŸ— ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        å‰ç«¯å±‚                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚ å¯¹è¯ç•Œé¢  â”‚  â”‚ æ–‡æ¡£ç®¡ç†  â”‚  â”‚ å†å²è®°å½•  â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ HTTP/REST API
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      API ç½‘å…³å±‚                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚ å¯¹è¯ API  â”‚  â”‚ æ–‡æ¡£ API  â”‚  â”‚ ç®¡ç† API  â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ä¸šåŠ¡é€»è¾‘å±‚                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚ RAG æœåŠ¡  â”‚  â”‚ Agent æœåŠ¡ â”‚  â”‚ MCP æœåŠ¡  â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      æ•°æ®è®¿é—®å±‚                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚ å‘é‡æ£€ç´¢  â”‚  â”‚ æ–‡æ¡£å­˜å‚¨  â”‚  â”‚ å¯¹è¯å†å²  â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      æ•°æ®å­˜å‚¨å±‚                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚ PostgreSQLâ”‚  â”‚ pgvector â”‚  â”‚ æ–‡ä»¶å­˜å‚¨  â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      AI æ¨¡å‹å±‚                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚ OpenAI   â”‚  â”‚ Claude   â”‚  â”‚ æœ¬åœ°æ¨¡å‹  â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚

- JDK 21 æˆ–æ›´é«˜ç‰ˆæœ¬
- Maven 3.8+ æˆ– Gradle 7+
- PostgreSQL 15+ï¼ˆå·²å®‰è£… pgvector æ‰©å±•ï¼‰
- Node.js 18+ å’Œ npm/yarnï¼ˆå‰ç«¯å¼€å‘ï¼‰

### 1. å…‹éš†é¡¹ç›®

```bash
git clone <repository-url>
cd Ai-agent
```

### 2. æ•°æ®åº“è®¾ç½®

#### å®‰è£… pgvector æ‰©å±•

```sql
-- è¿æ¥åˆ° PostgreSQL
CREATE EXTENSION IF NOT EXISTS vector;

-- åˆ›å»ºæ•°æ®åº“
CREATE DATABASE ai_agent_db;

-- è¿æ¥åˆ°æ–°æ•°æ®åº“
\c ai_agent_db

-- éªŒè¯æ‰©å±•
SELECT * FROM pg_extension WHERE extname = 'vector';
```

#### åˆå§‹åŒ–æ•°æ®åº“è¡¨

æ‰‹åŠ¨æ‰§è¡Œ `src/main/resources/db/migration/` ä¸‹çš„ SQL è„šæœ¬åˆ›å»ºè¡¨ç»“æ„ï¼Œæˆ–ä½¿ç”¨ Flyway/Liquibase è¿›è¡Œæ•°æ®åº“ç‰ˆæœ¬ç®¡ç†ã€‚

### 3. åç«¯é…ç½®

#### åˆ›å»ºé…ç½®æ–‡ä»¶

å¤åˆ¶ `src/main/resources/application.example.yml` ä¸º `application.yml`ï¼š

```yaml
spring:
  application:
    name: ai-agent
  datasource:
    url: jdbc:postgresql://localhost:5432/ai_agent_db
    username: your_username
    password: your_password
    driver-class-name: org.postgresql.Driver
  
  # MyBatis é…ç½®
  mybatis:
    mapper-locations: classpath:mapper/*.xml
    type-aliases-package: com.aiagent.model
    configuration:
      map-underscore-to-camel-case: true
      log-impl: org.apache.ibatis.logging.stdout.StdOutImpl

spring.ai:
  # OpenAI é…ç½®ï¼ˆå¯é€‰ï¼‰
  openai:
    api-key: ${OPENAI_API_KEY}
    chat:
      options:
        model: gpt-4
        temperature: 0.7
        max-tokens: 2000
  
  # Ollama é…ç½®ï¼ˆæœ¬åœ°æ¨¡å‹ï¼Œæ¨èï¼‰
  ollama:
    base-url: http://localhost:11434
    chat:
      options:
        model: llama2  # æˆ–å…¶ä»–æ¨¡å‹ï¼Œå¦‚ mistral, codellama ç­‰
        temperature: 0.7
        num-predict: 2000
  
  # Embedding é…ç½®ï¼ˆå¦‚æœä½¿ç”¨ Ollama çš„ embedding æ¨¡å‹ï¼‰
  embedding:
    ollama:
      base-url: http://localhost:11434
      options:
        model: nomic-embed-text  # Ollama embedding æ¨¡å‹
  
  vectorstore:
    postgresql:
      index-type: HNSW
      distance-type: COSINE_DISTANCE
      dimensions: 768  # Ollama embedding ç»´åº¦ï¼ˆnomic-embed-text ä¸º 768ï¼ŒOpenAI ä¸º 1536ï¼‰

server:
  port: 8080

logging:
  level:
    org.springframework.ai: DEBUG
    com.yourpackage: DEBUG
```

#### è®¾ç½®ç¯å¢ƒå˜é‡

**ä½¿ç”¨ OpenAIï¼š**
```bash
export OPENAI_API_KEY=your_openai_api_key
```

**ä½¿ç”¨ Ollamaï¼ˆæœ¬åœ°æ¨¡å‹ï¼Œæ— éœ€ API Keyï¼‰ï¼š**
```bash
# ç¡®ä¿ Ollama å·²å®‰è£…å¹¶è¿è¡Œ
# macOS é€šè¿‡ Docker å®‰è£…åï¼ŒOllama é»˜è®¤è¿è¡Œåœ¨ http://localhost:11434
# éªŒè¯ Ollama æ˜¯å¦è¿è¡Œï¼š
curl http://localhost:11434/api/tags

# ä¸‹è½½æ¨¡å‹ï¼ˆå¦‚æœªä¸‹è½½ï¼‰ï¼š
# docker exec -it <ollama-container> ollama pull llama2
# æˆ–ç›´æ¥åœ¨ä¸»æœºä¸Šï¼šollama pull llama2
```

### 4. è¿è¡Œåç«¯

```bash
# ä½¿ç”¨ Maven
mvn spring-boot:run

# æˆ–ä½¿ç”¨ Gradle
./gradlew bootRun
```

### 5. å‰ç«¯è®¾ç½®

```bash
cd frontend
npm install
npm run dev
```

å‰ç«¯å°†åœ¨ `http://localhost:3000` è¿è¡Œã€‚

## ğŸ¤– Ollama é…ç½®

å¦‚æœæ‚¨å·²ç»åœ¨ macOS ä¸Šé€šè¿‡ Docker å®‰è£…äº† Ollamaï¼Œå¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤é…ç½®ï¼š

### å¿«é€Ÿé…ç½®

1. **éªŒè¯ Ollama è¿è¡Œ**ï¼š
```bash
curl http://localhost:11434/api/tags
```

2. **ä¸‹è½½æ¨¡å‹**ï¼ˆå¦‚æœæœªä¸‹è½½ï¼‰ï¼š
```bash
# å¦‚æœ Ollama åœ¨ Docker å®¹å™¨ä¸­
docker exec -it <ollama-container> ollama pull llama2

# æ¨èæ¨¡å‹ï¼š
# ollama pull mistral        # Mistral 7B
# ollama pull qwen2.5        # ä¸­æ–‡æ”¯æŒå¥½
```

3. **é…ç½® application.yml**ï¼š
```yaml
spring.ai:
  ollama:
    base-url: http://localhost:11434
    chat:
      options:
        model: llama2
        temperature: 0.7
```

è¯¦ç»†é…ç½®è¯´æ˜è¯·å‚è€ƒï¼š[Ollama é…ç½®æŒ‡å—](docs/ollama-setup.md)

## ğŸ“ é¡¹ç›®ç»“æ„

```
Ai-agent/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ main/
â”‚   â”‚   â”‚   â”œâ”€â”€ java/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ com/
â”‚   â”‚   â”‚   â”‚       â””â”€â”€ aiagent/
â”‚   â”‚   â”‚   â”‚           â”œâ”€â”€ AiAgentApplication.java
â”‚   â”‚   â”‚   â”‚           â”œâ”€â”€ config/
â”‚   â”‚   â”‚   â”‚           â”‚   â”œâ”€â”€ AiConfig.java          # AI é…ç½®
â”‚   â”‚   â”‚   â”‚           â”‚   â”œâ”€â”€ VectorStoreConfig.java # å‘é‡å­˜å‚¨é…ç½®
â”‚   â”‚   â”‚   â”‚           â”‚   â””â”€â”€ WebConfig.java          # Web é…ç½®
â”‚   â”‚   â”‚   â”‚           â”œâ”€â”€ controller/
â”‚   â”‚   â”‚   â”‚           â”‚   â”œâ”€â”€ ChatController.java    # å¯¹è¯ API
â”‚   â”‚   â”‚   â”‚           â”‚   â”œâ”€â”€ DocumentController.java # æ–‡æ¡£ API
â”‚   â”‚   â”‚   â”‚           â”‚   â””â”€â”€ AgentController.java    # Agent API
â”‚   â”‚   â”‚   â”‚           â”œâ”€â”€ service/
â”‚   â”‚   â”‚   â”‚           â”‚   â”œâ”€â”€ RAGService.java        # RAG æœåŠ¡
â”‚   â”‚   â”‚   â”‚           â”‚   â”œâ”€â”€ AgentService.java      # Agent æœåŠ¡
â”‚   â”‚   â”‚   â”‚           â”‚   â”œâ”€â”€ MCPService.java        # MCP æœåŠ¡
â”‚   â”‚   â”‚   â”‚           â”‚   â””â”€â”€ DocumentService.java   # æ–‡æ¡£æœåŠ¡
â”‚   â”‚   â”‚   â”‚           â”œâ”€â”€ mapper/                    # MyBatis Mapper æ¥å£
â”‚   â”‚   â”‚   â”‚           â”‚   â”œâ”€â”€ DocumentMapper.java
â”‚   â”‚   â”‚   â”‚           â”‚   â”œâ”€â”€ ChatHistoryMapper.java
â”‚   â”‚   â”‚   â”‚           â”‚   â””â”€â”€ VectorMapper.java
â”‚   â”‚   â”‚   â”‚           â”œâ”€â”€ model/
â”‚   â”‚   â”‚   â”‚           â”‚   â”œâ”€â”€ Document.java
â”‚   â”‚   â”‚   â”‚           â”‚   â”œâ”€â”€ ChatMessage.java
â”‚   â”‚   â”‚   â”‚           â”‚   â””â”€â”€ VectorEmbedding.java
â”‚   â”‚   â”‚   â”‚           â””â”€â”€ dto/
â”‚   â”‚   â”‚   â”‚               â”œâ”€â”€ ChatRequest.java
â”‚   â”‚   â”‚   â”‚               â”œâ”€â”€ ChatResponse.java
â”‚   â”‚   â”‚   â”‚               â””â”€â”€ DocumentUploadRequest.java
â”‚   â”‚   â”‚   â””â”€â”€ resources/
â”‚   â”‚   â”‚       â”œâ”€â”€ application.yml
â”‚   â”‚   â”‚       â”œâ”€â”€ mapper/                # MyBatis XML æ˜ å°„æ–‡ä»¶
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ DocumentMapper.xml
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ ChatHistoryMapper.xml
â”‚   â”‚   â”‚       â”‚   â””â”€â”€ VectorMapper.xml
â”‚   â”‚   â”‚       â””â”€â”€ db/migration/
â”‚   â”‚   â””â”€â”€ test/
â”‚   â””â”€â”€ pom.xml æˆ– build.gradle
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”‚   â”œâ”€â”€ Chat/
â”‚   â”‚   â”‚   â”œâ”€â”€ Document/
â”‚   â”‚   â”‚   â””â”€â”€ History/
â”‚   â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ hooks/
â”‚   â”‚   â””â”€â”€ utils/
â”‚   â”œâ”€â”€ public/
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ vite.config.ts
â”œâ”€â”€ docs/
â”‚   â”œâ”€â”€ architecture.md      # æ¶æ„è®¾è®¡æ–‡æ¡£
â”‚   â”œâ”€â”€ api.md              # API æ–‡æ¡£
â”‚   â””â”€â”€ deployment.md       # éƒ¨ç½²æ–‡æ¡£
â”œâ”€â”€ docker/
â”‚   â”œâ”€â”€ Dockerfile
â”‚   â””â”€â”€ docker-compose.yml
â””â”€â”€ README.md
```

## ğŸ“– å¼€å‘æŒ‡å—

### åç«¯å¼€å‘

#### 1. RAG æœåŠ¡å®ç°

RAG æœåŠ¡çš„æ ¸å¿ƒæµç¨‹ï¼š

1. **æ–‡æ¡£ä¸Šä¼ **ï¼šæ¥æ”¶ç”¨æˆ·ä¸Šä¼ çš„æ–‡æ¡£
2. **æ–‡æ¡£è§£æ**ï¼šæå–æ–‡æœ¬å†…å®¹
3. **æ–‡æ¡£åˆ†å—**ï¼šå°†é•¿æ–‡æ¡£åˆ†å‰²æˆå°å—
4. **å‘é‡åŒ–**ï¼šä½¿ç”¨ Embedding æ¨¡å‹ç”Ÿæˆå‘é‡
5. **å­˜å‚¨**ï¼šå°†å‘é‡å­˜å‚¨åˆ° PostgreSQL
6. **æ£€ç´¢**ï¼šæ ¹æ®ç”¨æˆ·é—®é¢˜æ£€ç´¢ç›¸å…³æ–‡æ¡£å—
7. **ç”Ÿæˆ**ï¼šå°†æ£€ç´¢åˆ°çš„æ–‡æ¡£ä½œä¸ºä¸Šä¸‹æ–‡ï¼Œç”Ÿæˆå›ç­”

#### 2. Agent æœåŠ¡å®ç°

Agent æœåŠ¡æ”¯æŒï¼š
- å¯¹è¯çŠ¶æ€ç®¡ç†
- å·¥å…·è°ƒç”¨ï¼ˆå¦‚æœç´¢ã€è®¡ç®—ç­‰ï¼‰
- å¤šæ­¥éª¤ä»»åŠ¡è§„åˆ’
- è®°å¿†æŒä¹…åŒ–

#### 3. MCP æœåŠ¡å®ç°

MCP æœåŠ¡æä¾›ï¼š
- ä¸Šä¸‹æ–‡åˆ›å»ºå’Œç®¡ç†
- ä¸Šä¸‹æ–‡æ›´æ–°å’ŒæŸ¥è¯¢
- ä¸Šä¸‹æ–‡ç‰ˆæœ¬æ§åˆ¶

### å‰ç«¯å¼€å‘

#### æŠ€æœ¯é€‰å‹å»ºè®®

**React ç‰ˆæœ¬ï¼š**
- React 18
- TypeScript
- Tailwind CSS
- React Query
- Zustandï¼ˆçŠ¶æ€ç®¡ç†ï¼‰
- React Router

**Vue ç‰ˆæœ¬ï¼š**
- Vue 3 + Composition API
- TypeScript
- Tailwind CSS
- Vue Query
- Piniaï¼ˆçŠ¶æ€ç®¡ç†ï¼‰
- Vue Router

#### UI ç»„ä»¶åº“æ¨è

- **shadcn/ui**ï¼ˆReactï¼‰
- **Radix Vue**ï¼ˆVueï¼‰
- **Headless UI**

## ğŸš¢ éƒ¨ç½²è¯´æ˜

### Docker éƒ¨ç½²

#### 1. æ„å»ºé•œåƒ

```bash
docker build -t ai-agent-backend ./backend
docker build -t ai-agent-frontend ./frontend
```

#### 2. ä½¿ç”¨ Docker Compose

```yaml
version: '3.8'
services:
  postgres:
    image: pgvector/pgvector:pg15
    environment:
      POSTGRES_DB: ai_agent_db
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: postgres
    ports:
      - "5432:5432"
    volumes:
      - postgres_data:/var/lib/postgresql/data

  ollama:
    image: ollama/ollama:latest
    container_name: ai-agent-ollama
    ports:
      - "11434:11434"
    volumes:
      - ollama_data:/root/.ollama
    networks:
      - ai-agent-network
    restart: unless-stopped

  backend:
    build: ./backend
    ports:
      - "8080:8080"
    environment:
      SPRING_DATASOURCE_URL: jdbc:postgresql://postgres:5432/ai_agent_db
      # ä½¿ç”¨ OpenAIï¼ˆå¯é€‰ï¼‰
      OPENAI_API_KEY: ${OPENAI_API_KEY}
      # ä½¿ç”¨ Ollamaï¼ˆæ¨èæœ¬åœ°å¼€å‘ï¼‰
      SPRING_AI_OLLAMA_BASE_URL: http://ollama:11434
    depends_on:
      - postgres
      - ollama

  frontend:
    build: ./frontend
    ports:
      - "3000:3000"
    depends_on:
      - backend

volumes:
  postgres_data:
  ollama_data:
```

è¿è¡Œï¼š

```bash
docker-compose up -d
```

### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

1. **åç«¯**ï¼šä½¿ç”¨ Spring Boot æ‰“åŒ…ä¸º JARï¼Œéƒ¨ç½²åˆ°æœåŠ¡å™¨æˆ–å®¹å™¨
2. **å‰ç«¯**ï¼šæ„å»ºé™æ€æ–‡ä»¶ï¼Œéƒ¨ç½²åˆ° Nginx æˆ– CDN
3. **æ•°æ®åº“**ï¼šä½¿ç”¨äº‘æ•°æ®åº“æœåŠ¡ï¼ˆå¦‚ AWS RDSã€Azure Databaseï¼‰

## ğŸ“š API æ–‡æ¡£

### å¯¹è¯ API

#### POST /api/chat

å‘é€æ¶ˆæ¯å¹¶è·å– AI å›å¤

**è¯·æ±‚ä½“ï¼š**
```json
{
  "message": "ç”¨æˆ·æ¶ˆæ¯",
  "conversationId": "å¯é€‰ï¼Œå¯¹è¯ID",
  "useRAG": true,
  "useAgent": false
}
```

**å“åº”ï¼š**
```json
{
  "message": "AI å›å¤",
  "conversationId": "å¯¹è¯ID",
  "sources": ["ç›¸å…³æ–‡æ¡£å¼•ç”¨"],
  "timestamp": "2024-01-01T00:00:00Z"
}
```

### æ–‡æ¡£ API

#### POST /api/documents/upload

ä¸Šä¼ æ–‡æ¡£

**è¯·æ±‚ï¼š** multipart/form-data
- `file`: æ–‡ä»¶
- `title`: æ–‡æ¡£æ ‡é¢˜ï¼ˆå¯é€‰ï¼‰

**å“åº”ï¼š**
```json
{
  "documentId": "æ–‡æ¡£ID",
  "title": "æ–‡æ¡£æ ‡é¢˜",
  "status": "processing"
}
```

#### GET /api/documents

è·å–æ–‡æ¡£åˆ—è¡¨

#### DELETE /api/documents/{id}

åˆ é™¤æ–‡æ¡£

è¯¦ç»† API æ–‡æ¡£è¯·å‚è€ƒ [docs/api.md](docs/api.md)

## â“ å¸¸è§é—®é¢˜

### Q: å¦‚ä½•åˆ‡æ¢ AI æ¨¡å‹ï¼Ÿ

A: åœ¨ `application.yml` ä¸­ä¿®æ”¹é…ç½®ï¼š
- **ä½¿ç”¨ OpenAI**ï¼šé…ç½® `spring.ai.openai` éƒ¨åˆ†
- **ä½¿ç”¨ Ollamaï¼ˆæœ¬åœ°ï¼‰**ï¼šé…ç½® `spring.ai.ollama` éƒ¨åˆ†ï¼Œç¡®ä¿ Ollama æœåŠ¡è¿è¡Œåœ¨ `http://localhost:11434`

### Q: å¦‚ä½•é…ç½® Ollamaï¼Ÿ

A: 
1. ç¡®ä¿ Ollama å·²é€šè¿‡ Docker å®‰è£…å¹¶è¿è¡Œ
2. åœ¨ `application.yml` ä¸­é…ç½® `spring.ai.ollama.base-url: http://localhost:11434`
3. é€‰æ‹©è¦ä½¿ç”¨çš„æ¨¡å‹ï¼ˆå¦‚ `llama2`, `mistral`, `codellama` ç­‰ï¼‰
4. å¦‚æœä½¿ç”¨ Docker å®‰è£…çš„ Ollamaï¼Œç¡®ä¿ç«¯å£æ˜ å°„æ­£ç¡®ï¼ˆé»˜è®¤ 11434ï¼‰

### Q: å‘é‡ç»´åº¦å¦‚ä½•è®¾ç½®ï¼Ÿ

A: æ ¹æ®ä½¿ç”¨çš„ Embedding æ¨¡å‹è®¾ç½®ï¼š
- OpenAI: 1536
- Ollama (nomic-embed-text): 768
- Cohere: 1024
- è‡ªå®šä¹‰æ¨¡å‹: æ ¹æ®æ¨¡å‹è¾“å‡ºç»´åº¦

### Q: å¦‚ä½•æé«˜æ£€ç´¢å‡†ç¡®æ€§ï¼Ÿ

A: 
1. è°ƒæ•´æ–‡æ¡£åˆ†å—å¤§å°å’Œé‡å 
2. ä½¿ç”¨æ›´å¥½çš„ Embedding æ¨¡å‹
3. è°ƒæ•´ç›¸ä¼¼åº¦é˜ˆå€¼
4. ä½¿ç”¨æ··åˆæ£€ç´¢ï¼ˆå…³é”®è¯ + å‘é‡ï¼‰

### Q: å‰ç«¯å¦‚ä½•è¿æ¥åç«¯ï¼Ÿ

A: åœ¨ `.env` æ–‡ä»¶ä¸­è®¾ç½®ï¼š
```
VITE_API_BASE_URL=http://localhost:8080/api
```

